(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[421],{3918:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/beat/[id]",function(){return s(5307)}])},5307:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return h}});var r=s(5893),n=s(1163),l=s(7294);let a=(0,s(8967).eI)("https://ssaxfvlcpjygsdyymlvy.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNzYXhmdmxjcGp5Z3NkeXltbHZ5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDc1NTgwMTgsImV4cCI6MjA2MzEzNDAxOH0.lpq3C8QCZT3aW3kDb5SgYmr0fS3cvXAyaQDIqsmMDFE");var c=s(6179),i=s(9482),o=s(9769),u=s(1787),d=s(3718);let x=null,p=null;var m=e=>{let{beat:t,showCopyLink:s=!0,onDelete:n}=e,a=(0,l.useRef)(null),[m,h]=(0,l.useState)(!1),[f,g]=(0,l.useState)(!1),b=async()=>{try{let e="".concat(window.location.origin,"/beat/").concat(t.id);await navigator.clipboard.writeText(e),g(!0),setTimeout(()=>g(!1),2e3)}catch(e){console.error("Failed to copy link:",e)}};return(0,r.jsxs)("div",{className:"w-full max-w-xl bg-white rounded-xl shadow-md text-gray-800 flex flex-row overflow-hidden",children:[(0,r.jsxs)("div",{className:"relative w-32 h-32 sm:w-36 sm:h-36 flex-shrink-0",children:[(0,r.jsx)("img",{src:t.coverArt,alt:t.name,className:"w-full h-full object-cover"}),(0,r.jsx)("button",{onClick:()=>{a.current&&(a.current.paused?(x&&x!==a.current&&(x.pause(),p&&p(!1)),a.current.play(),h(!0),x=a.current,p=h):(a.current.pause(),h(!1),x===a.current&&(x=null,p=null)))},className:"absolute top-2 right-2 bg-blue-600 text-white rounded-full p-2 shadow-md",children:m?(0,r.jsx)(c.Z,{size:20}):(0,r.jsx)(i.Z,{size:20})})]}),(0,r.jsxs)("div",{className:"flex-1 p-4 space-y-1",children:[(0,r.jsx)("h3",{className:"text-base font-semibold truncate text-gray-900",children:t.name}),(0,r.jsx)("p",{className:"text-sm text-gray-600 truncate",children:t.uploader}),(0,r.jsxs)("p",{className:"text-xs text-gray-500 truncate",children:[t.key," â€¢ ",t.bpm," BPM"]}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-2 pt-3 items-center",children:[(0,r.jsxs)("span",{className:"text-sm font-semibold bg-red-600 text-white px-3 py-1 rounded-full whitespace-nowrap",children:["NPR ",t.price.toFixed(2)]}),(0,r.jsxs)("button",{onClick:()=>window.open("tel:".concat(t.producerPhone),"_self"),className:"flex items-center gap-1 text-sm bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded-full",children:[(0,r.jsx)(o.Z,{size:14})," Buy"]}),s&&(0,r.jsx)("button",{onClick:b,title:f?"Link copied!":"Copy link",className:"p-1.5 rounded-full ".concat(f?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:(0,r.jsx)(u.Z,{size:14})}),n&&(0,r.jsxs)("button",{onClick:n,className:"flex items-center gap-1 text-sm bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded-full",children:[(0,r.jsx)(d.Z,{size:14})," Delete"]})]})]}),(0,r.jsx)("audio",{ref:a,src:t.audioUrl,onEnded:()=>{h(!1),x===a.current&&(x=null,p=null)},hidden:!0})]})};function h(){let{id:e}=(0,n.useRouter)().query,[t,s]=(0,l.useState)(null);return((0,l.useEffect)(()=>{e&&(async()=>{let{data:t,error:r}=await a.from("beats").select("*").eq("id",e).single();!r&&t?s(t):console.error("Error fetching beat:",r)})()},[e]),t)?(0,r.jsx)("div",{className:"min-h-screen bg-gray-100 py-10 px-4 flex items-center justify-center",children:(0,r.jsx)("div",{className:"w-full max-w-xl",children:(0,r.jsx)(m,{beat:{id:t.id,name:t.name,key:t.key,bpm:t.bpm,price:t.price,phone:t.phone,uploader:t.uploader,coverArt:t.cover_url,audioUrl:t.audio_url,producerPhone:t.phone},showCopyLink:!0})})}):(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center text-gray-600 text-sm",children:"Beat not found or loading..."})}}},function(e){e.O(0,[605,888,774,179],function(){return e(e.s=3918)}),_N_E=e.O()}]);