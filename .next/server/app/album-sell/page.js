(()=>{var e={};e.id=267,e.ids=[267],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},1453:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>m,originalPathname:()=>d,pages:()=>c,routeModule:()=>p,tree:()=>u});var s=r(482),l=r(9108),a=r(2563),i=r.n(a),n=r(8300),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);r.d(t,o);let u=["",{children:["album-sell",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,5222)),"R:\\original\\app\\album-sell\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,2917)),"R:\\original\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9361,23)),"next/dist/client/components/not-found-error"]}],c=["R:\\original\\app\\album-sell\\page.tsx"],d="/album-sell/page",m={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:l.x.APP_PAGE,page:"/album-sell/page",pathname:"/album-sell",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:u}})},253:(e,t,r)=>{Promise.resolve().then(r.bind(r,6815))},2439:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,2583,23)),Promise.resolve().then(r.t.bind(r,6840,23)),Promise.resolve().then(r.t.bind(r,8771,23)),Promise.resolve().then(r.t.bind(r,3225,23)),Promise.resolve().then(r.t.bind(r,9295,23)),Promise.resolve().then(r.t.bind(r,3982,23))},3690:()=>{},6815:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var s=r(5344),l=r(3729),a=r(4173),i=r(2312),n=r(6911);function o({album:e}){let[t,r]=(0,l.useState)(!1),[a,o]=(0,l.useState)(!1),u=(0,l.useRef)([]);(0,l.useEffect)(()=>{u.current.forEach((e,t)=>{e&&(e.onplay=()=>{u.current.forEach((e,r)=>{t!==r&&e&&!e.paused&&e.pause()})})})},[]);let c=async()=>{try{await navigator.clipboard.writeText(window.location.href),o(!0),setTimeout(()=>o(!1),2e3)}catch(e){console.error("Failed to copy:",e)}};return"Test Album"===e.name&&"Test Artist"===e.artist_name?null:(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-md hover:shadow-lg transition-all w-full max-w-sm mx-auto flex flex-col overflow-hidden",children:[(0,s.jsxs)("div",{className:"relative aspect-square w-full",children:[s.jsx("img",{src:e.cover_url||"https://via.placeholder.com/300?text=No+Cover",alt:"Album Cover",className:"object-cover w-full h-full rounded-t-2xl"}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/30 to-transparent rounded-t-2xl"})]}),(0,s.jsxs)("div",{className:"p-5 flex flex-col gap-4",children:[(0,s.jsxs)("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-blue-900 truncate",children:e.name||"Untitled Album"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 truncate",children:["By ",e.artist_name||"Unknown Artist"]}),(0,s.jsxs)("p",{className:"text-green-600 font-semibold mt-1",children:["NPR ",e.price]})]}),s.jsx("div",{className:"space-y-2",children:[e.preview_1_url,e.preview_2_url,e.preview_3_url].map((e,t)=>e&&s.jsx("audio",{ref:e=>{e&&(u.current[t]=e)},controls:!0,controlsList:"nodownload",className:"w-full rounded border",src:e},t))}),(0,s.jsxs)("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:()=>r(!0),className:"flex-1 py-2.5 px-4 bg-blue-600 text-white text-sm font-medium rounded-lg flex items-center justify-center gap-2 hover:bg-blue-700 transition-colors",children:"Buy Album"}),s.jsx("button",{onClick:c,className:"py-2.5 px-3 bg-gray-100 text-gray-700 text-sm font-medium rounded-lg flex items-center justify-center gap-2 hover:bg-gray-200 transition","aria-label":"Copy link",children:a?s.jsx(i.Z,{size:16,className:"text-green-600"}):s.jsx(n.Z,{size:16})})]})]}),t&&s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex justify-center items-center p-4",children:(0,s.jsxs)("div",{className:"bg-white p-6 rounded-xl w-full max-w-sm text-center shadow-xl",children:[s.jsx("h3",{className:"text-xl font-bold mb-4 text-blue-800",children:"Contact to Purchase"}),s.jsx("img",{src:e.qr_code_url,alt:"QR Code",className:"w-40 h-40 mx-auto rounded mb-4"}),(0,s.jsxs)("p",{className:"text-lg text-green-700 font-semibold",children:["\uD83D\uDCDE ",e.phone_number]}),s.jsx("button",{onClick:()=>r(!1),className:"mt-6 bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded-full transition",children:"Close"})]})})]})}function u(){let[e,t]=(0,l.useState)(null),[r,i]=(0,l.useState)({name:"",artist:"",price:"",phone:"",coverImage:null,preview1:null,preview2:null,preview3:null,qrCode:null}),[n,o]=(0,l.useState)(!1),[u,c]=(0,l.useState)("");(0,l.useEffect)(()=>{a.O.auth.getSession().then(({data:e})=>{t(e.session),console.log("\uD83D\uDD10 SESSION:",e.session)})},[]);let d=e=>{let{name:t,value:r,files:s}=e.target;s?i(e=>({...e,[t]:s[0]})):i(e=>({...e,[t]:r}))},m=async(e,t)=>{let r=t.name.replace(/\s+/g,"_"),s=`${Date.now()}-${r}`,{data:l,error:i}=await a.O.storage.from(e).upload(s,t);if(i)throw console.error("❌ Upload error:",i.message),i;let{data:n}=a.O.storage.from(e).getPublicUrl(s);return n.publicUrl},p=async t=>{if(t.preventDefault(),c(""),!e?.user?.id){alert("❌ You must be logged in.");return}console.log("\uD83D\uDCE4 Uploading as user:",e.user.id),o(!0);try{let t=await m("album-covers",r.coverImage),s=await m("album-previews",r.preview1),l=await m("album-previews",r.preview2),i=await m("album-previews",r.preview3),n=await m("album-qrcodes",r.qrCode),o={name:r.name,artist_name:r.artist,price:r.price,phone_number:r.phone,user_id:e.user.id,album_url:null,cover_url:t,preview_1_url:s,preview_2_url:l,preview_3_url:i,qr_code_url:n};console.log("⬆️ INSERTING album:",o);let{data:u,error:d}=await a.O.from("albums").insert(o).select("*");if(d){console.error("\uD83D\uDEAB INSERT ERROR:",d.message),c("Upload failed: "+d.message);return}alert("✅ Album uploaded successfully!")}catch(e){console.error("⚠️ Unexpected error:",e.message),c("Upload failed: "+e.message)}o(!1)};return(0,s.jsxs)("div",{children:[e?.user?.id?(0,s.jsxs)("div",{className:"p-3 mb-4 bg-green-100 text-green-800 rounded text-sm",children:["✅ Logged in as: ",s.jsx("b",{children:e.user.id})]}):s.jsx("div",{className:"p-3 mb-4 bg-red-100 text-red-800 rounded text-sm",children:"❌ Not logged in."}),u&&s.jsx("div",{className:"p-3 mb-4 bg-red-100 text-red-800 rounded text-sm",children:u}),(0,s.jsxs)("form",{onSubmit:p,className:"space-y-6 w-full max-w-2xl text-gray-800",children:[s.jsx("h2",{className:"text-3xl font-bold text-center text-blue-900",children:"Upload New Album"}),(0,s.jsxs)("div",{className:"space-y-4",children:[s.jsx("input",{type:"text",name:"name",onChange:d,placeholder:"Album Name",className:"w-full p-3 border rounded",required:!0}),s.jsx("input",{type:"text",name:"artist",onChange:d,placeholder:"Artist Name",className:"w-full p-3 border rounded",required:!0}),s.jsx("input",{type:"number",name:"price",onChange:d,placeholder:"Price (NPR)",className:"w-full p-3 border rounded",required:!0}),s.jsx("input",{type:"text",name:"phone",onChange:d,placeholder:"Phone Number",className:"w-full p-3 border rounded",required:!0}),s.jsx("input",{type:"file",name:"coverImage",accept:"image/*",onChange:d,required:!0}),s.jsx("input",{type:"file",name:"preview1",accept:"audio/mp3",onChange:d,required:!0}),s.jsx("input",{type:"file",name:"preview2",accept:"audio/mp3",onChange:d,required:!0}),s.jsx("input",{type:"file",name:"preview3",accept:"audio/mp3",onChange:d,required:!0}),s.jsx("input",{type:"file",name:"qrCode",accept:"image/*",onChange:d,required:!0}),s.jsx("button",{type:"submit",disabled:n,className:"w-full bg-blue-600 text-white py-3 rounded",children:n?"Uploading...":"Upload Album"})]})]})]})}var c=r(4684),d=r(712);function m(){let[e,t]=(0,l.useState)([]),[r,i]=(0,l.useState)(null);return(0,l.useEffect)(()=>{let e=async()=>{let{data:e,error:t}=await a.O.auth.getUser();!t&&e?.user&&i(e.user)};(async()=>{let{data:e,error:r}=await a.O.from("albums").select("*");!r&&e?t(e):console.error("Error loading albums:",r)})(),e()},[]),(0,s.jsxs)("div",{className:"min-h-screen flex flex-col bg-gradient-to-br from-blue-50 to-white",children:[s.jsx(c.Z,{onUploadClick:()=>{}}),(0,s.jsxs)("main",{className:"px-4 sm:px-6 lg:px-12 py-10 grow",children:[s.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-center text-blue-900 mb-12",children:"\uD83C\uDFB5 Explore Albums for Sale"}),r?.id==="592d839a-739f-4043-bea7-6e96f4c8f456"&&s.jsx("div",{className:"flex justify-center mb-12",children:s.jsx("div",{className:"bg-white shadow-lg rounded-2xl p-6 w-full max-w-3xl",children:s.jsx(u,{})})}),s.jsx("div",{className:"overflow-x-auto hide-scrollbar",children:s.jsx("div",{className:"flex flex-nowrap gap-6 sm:grid sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:e.length>0?e.map(e=>s.jsx("div",{className:"flex-shrink-0 sm:flex-shrink sm:contents",children:s.jsx(o,{album:e})},e.id)):s.jsx("p",{className:"text-center text-gray-600 col-span-full",children:"No albums uploaded yet."})})})]}),s.jsx(d.Z,{})]})}},4173:(e,t,r)=>{"use strict";r.d(t,{O:()=>s});let s=(0,r(3125).eI)("https://ssaxfvlcpjygsdyymlvy.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNzYXhmdmxjcGp5Z3NkeXltbHZ5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDc1NTgwMTgsImV4cCI6MjA2MzEzNDAxOH0.lpq3C8QCZT3aW3kDb5SgYmr0fS3cvXAyaQDIqsmMDFE")},2312:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(7075).Z)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},6911:(e,t,r)=>{"use strict";r.d(t,{Z:()=>s});let s=(0,r(7075).Z)("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]])},5222:(e,t,r)=>{"use strict";r.r(t),r.d(t,{$$typeof:()=>a,__esModule:()=>l,default:()=>i});let s=(0,r(6843).createProxy)(String.raw`R:\original\app\album-sell\page.tsx`),{__esModule:l,$$typeof:a}=s,i=s.default},2917:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n,metadata:()=>i});var s=r(5036),l=r(265),a=r.n(l);r(4025);let i={title:"Beats4Nepal",description:"Buy and Sell Beats, Mixing & Mastering Services"};function n({children:e}){return s.jsx("html",{lang:"en",children:s.jsx("body",{className:a().className,children:e})})}},4025:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[483,125,754,272],()=>r(1453));module.exports=s})();